<!DOCTYPE html>
<html>
<head>
  <title>San Francisco's Web of Corruption</title>
  <link rel="icon" type="image/png" href="favicon.png"/>
  <meta content="text/html; charset=utf-8">
  <style>
    /* set styles */
    body {
      overflow: hidden;
      font-family: Calibri;
    }

    svg text {
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
    }

    .tooltipdiv {	
      position: absolute;			
      padding: 10px;				
      font: 14px sans-serif;		
      background: rgb(255, 255, 255);
      border: 2px solid black;
      border-radius: 3px;
      max-width: 220px;
      font-family: Calibri;
      font-weight: 300;
      margin-top: 0em;
      margin-bottom: 0em;
    }

    .tooltipdiv h4 {
      font-weight: 300;
      font-size: 1.2em;
      border-width: 0px 0px 0.5px 0px;
      border-style: solid;
      border-color: rgb(80, 80, 80);
      margin-top: 0em;
      margin-bottom: 0.5em;
	}
	.tooltipdiv h2 {
		font-weight: 500;
		margin-top: 0.5em;
		margin-bottom: 0.3em;
	}
	.tooltipdiv p {
		font-weight: 300;
		margin-top: 0.3em;
		margin-bottom: 0em;
	}

  text.shadow {
    text-shadow: 0px 0px 5px #ffffff, 0px 0px 5px #ffffff, 0px 0px 5px #ffffff, 0px 0px 5px #ffffff, 0px 0px 5px #ffffff, 0px 0px 5px #ffffff;
  }

  </style>
</head>
<body>
<svg></svg>
<script src="https://d3js.org/d3.v4.min.js"></script>

<script>

//
// VARIABLES LIVE HERE
//

// import data
var nodes = [{"id": "dpw", "label": "Department of Publics Works", "guilt": "other", "desc": "<h4>Department of Publics Works</h4><p>Run by Mohammed Nuru until Jan. 2020, when he was <a target='_blank' href='https://missionlocal.org/2020/01/mohammed-nuru-director-of-san-francisco-public-works-arrested-by-fbi/'>indicted on corruption charges</a>. Responsible for negotiating with waste management company Recology (which <a target='_blank' href='https://missionlocal.org/2021/03/recology-to-reimburse-san-franciscans-nearly-100m-following-city-attorney-investigation/'>overcharged San Franciscans almost $100 million</a>), ordering <a target='_blank' href='https://missionlocal.org/2021/09/san-francisco-garbage-can-designer/'>much-maligned trash cans</a> from the Walter Wong-affiliated Alternate Choice LLC, and purportedly turning down tens of millions of dollars in a public bid to <a target-='_blank' href='https://missionlocal.org/2020/07/nuru-jcdecaux-toilet-san-francisco/'>provide the city's toilets</a>.</p>", "photo": "images/sfdpw.png", "total_links": 7.0}, {"id": "dbi", "label": "Department of Building Inspection", "guilt": "other", "desc": "<h4>Department of Building Inspection</h4><p>The department, which is responsible for issuing building permits, has faced numerous charges of cronyism. Employees have taken large, undisclosed <a target='_blank' href='https://missionlocal.org/2021/09/scathing-report-on-dept-of-building-inspection-faults-years-of-toxic-leadership-broken-systems/'>\"loans\"</a> from developers and director <a target='_blank' href='https://missionlocal.org/2020/03/department-of-building-inspection-head-tom-hui-suspended-allegations-of-wrongdoing-stretching-back-to-2011-uncovered-during-city-attorney-probe-of-mohammed-nuru/'>Tom Hui was suspended</a> over a decade of misconduct.</p>", "photo": "images/sfdbi.png", "total_links": 8.0}, {"id": "mohammedNuru", "label": "Mohammed Nuru", "guilt": "charged", "desc": "<h4>Mohammed Nuru</h4><p>Former Director of the Department of Public Works Mohammed Nuru is facing a <a target='_blank' href='https://missionlocal.org/2020/01/mohammed-nuru-director-of-san-francisco-public-works-arrested-by-fbi/'>potential 20-year federal prison sentence on corruption charges</a>, and an additional five for allegedly lying to FBI agents. Nuru purportedly <a target='_blank' href='https://missionlocal.org/2020/11/feds-charge-recology-exec-in-long-running-alleged-mohammed-nuru-bribery-scheme/'>funnelled upwards of a million dollars</a> into non-profits to fund lavish parties and took bribes including <a target='_blank' href='https://missionlocal.org/2020/09/tractor-mohammed-nuru-fbi-doj/'>a tractor and a $40,000 Rolex</a>.</p>", "photo": "images/mohammedNuru.png", "total_links": 16.0}, {"id": "walterWong", "label": "Walter Wong", "guilt": "guilty", "desc": "<h4>Walter Wong</h4><p>Permit expediter and confessed federal criminal Walter Wong was <a target='_blank' href='https://missionlocal.org/2020/06/feds-level-charges-against-walter-wong-in-latest-salvo-of-ongoing-mohammed-nuru-probe/'>arrested on fraud and money-laundering charges</a> in June 2020. His businesses have received millions in city contracts \u2013 for example, a Wong-affliated company supplied the city's <a target='_blank' href='https://missionlocal.org/2020/02/citing-mohammed-nuru-charges-resolution-urges-san-francisco-to-flush-jcdecaux-toilet-contract/'>much-maligned Renaissance trash cans</a> \u2013 and he purportedly held such sway over the Department of Building Inspection that he had his own keys. He is now cooperating with the FBI.</p>", "photo": "images/walterWong.png", "total_links": 11.0}, {"id": "recology", "label": "Recology", "guilt": "guilty", "desc": "<h4>Recology</h4><p>Recology has had a monopoly on San Francisco's waste management since 1932. The company overcharged the city <a target='_blank' href='https://missionlocal.org/2021/03/recology-to-reimburse-san-franciscans-nearly-100m-following-city-attorney-investigation/'>$94.5 million since 2017</a>. In 2020, executives were <a target='_blank' href='https://missionlocal.org/2020/11/feds-charge-recology-exec-in-long-running-alleged-mohammed-nuru-bribery-scheme/'>federally charged for a bribery scheme</a> that saw over a million dollars sent to Mohammed Nuru to secure the company favorable rates.</p>", "photo": "images/recology.jpg", "total_links": 7.0}, {"id": "rodrigoSantos", "label": "Rodrigo Santos", "guilt": "charged", "desc": "<h4>Rodrigo Santos</h4><p>Onetime president of the Building Inspection Commission, Santos was federally charged with <a target='_blank' href='https://missionlocal.org/2020/09/rodrigo-santos-dbi/'>$478,000 of bank fraud</a> in Sep. 2020 after purportedly cashing checks destined for city departments to his own personal account. His charges were upped to <a target='_blank' href=\"https://www.justice.gov/usao-ndca/pr/former-san-francisco-building-inspection-commission-president-indicted-bank-fraud\">$775,400 of bank fraud</a> in July 2021. He also allegedly told developers to donate to Bernie Curran's favored non-profits in exchange for building permits, and he <a target='_blank' href='https://missionlocal.org/2021/08/rodrigo-santos-admits-to-hiring-ex-dbi-directors-kids-plural-and-other-gems-from-dennis-richards-ongoing-litigation/'>hired both of Tom Hui's sons</a>.</p>", "photo": "images/rodrigoSantos.jpg", "total_links": 3.0}, {"id": "555fulton", "label": "555 Fulton St.", "guilt": "other", "desc": "<h4>555 Fulton St.</h4><p>A building owned by Chinese billionaire Zhang Li, who <a target='_blank' href='https://missionlocal.org/2020/02/mohammed-nuru-investigation-city-attorney-fires-off-14-subpoenas-chinese-billionaire-developer-zhang-li-and-permit-expediter-walter-wong-targeted/'>lavishly entertained Mohammed Nuru</a> on a visit to China. Permit records for the building disappeared and then reappeared in Feb. 2020, prompting an FBI visit to the Department of Building Inspection. Permit expediter Walter Wong had his <a target='blank' href='https://missionlocal.org/2020/01/laffaire-mohammed-nuru-is-san-francisco-a-dysfunctional-government-or-a-functional-cartel-time-to-choose/'>offices raided</a> in relation to the project.</p>", "photo": "images/555fulton.png", "total_links": 5.0}, {"id": "bernieCurran", "label": "Bernie Curran", "guilt": "charged", "desc": "<h4>Bernie Curran</h4><p>Former senior inspector Bernie Curran has been federally charged with a <a target='_blank' href='https://missionlocal.org/2021/08/rodrigo-santos-admits-to-hiring-ex-dbi-directors-kids-plural-and-other-gems-from-dennis-richards-ongoing-litigation/'>bribery scheme</a>, in which he allegedly signed off projects in exchange for donations to his favored non-profits. He also <a target='_blank' href='https://missionlocal.org/2021/06/department-of-building-inspection-bernie-curran-2867-san-bruno-rebar-shmeebar/'>failed to disclose a $180,000 \"loan\"</a> from a developer tied to properties he worked on.</p>", "photo": "images/bernieCurran.jpg", "total_links": 8.0}, {"id": "patrickORiordan", "label": "Patrick O'Riordan", "guilt": "other", "desc": "<h4>Patrick O'Riordan</h4><p>Department of Building Inspection (DBI) interim director. Former direct supervisor of Bernie Curran. When gas pipes were being improperly encased in concrete in 2017, he told builders: \"<a target='_blank' href='https://missionlocal.org/2021/06/san-francisco-dbi-los-angeles-dbs-gas-line-grade-beam-seismic-retrofit/'>Do not stop the work</a>.\" O'Riordan purportedly <a target='_blank' href='https://missionlocal.org/2021/10/department-of-building-inspection-patrick-oriordan-mel-murphy-bernie-curran/'>kept inspectors off connected builders' sites</a> and he <a target='_blank' href='https://missionlocal.org/2021/09/scathing-report-on-dept-of-building-inspection-faults-years-of-toxic-leadership-broken-systems/'>erroneously told supervisors</a> that only managers can change DBI records.</p>", "photo": "images/patrickORiordan.jpg", "total_links": 2.0}, {"id": "tomHui", "label": "Tom Hui", "guilt": "other", "desc": "<h4>Tom Hui</h4><p>Former head of the Department of Building Inspection, Hui was <a target='_blank' href='https://missionlocal.org/2020/03/department-of-building-inspection-head-tom-hui-suspended-allegations-of-wrongdoing-stretching-back-to-2011-uncovered-during-city-attorney-probe-of-mohammed-nuru/'>suspended in Mar. 2020</a> over a decade of alleged wrongdoing. Purportedly he <a target='_blank' href='https://missionlocal.org/2020/03/department-of-building-inspection-head-tom-hui-suspended-allegations-of-wrongdoing-stretching-back-to-2011-uncovered-during-city-attorney-probe-of-mohammed-nuru/'>\"literally stood over people\u2019s shoulders\"</a> to push through the 555 Fulton St. project, <a target='_blank' href='https://missionlocal.org/2021/09/scathing-report-on-dept-of-building-inspection-faults-years-of-toxic-leadership-broken-systems/'>accepted inappropriate gifts</a>, and sent his preferred inspectors to visit preferred builders.</p>", "photo": "images/tomHui.jpg", "total_links": 5.0}, {"id": "naomiKelly", "label": "Naomi Kelly", "guilt": "other", "desc": "<h4>Naomi Kelly</h4><p>The former city administrator participated in a trip to Hong Kong and China in 2016, <a target='_blank' href='https://missionlocal.org/2020/11/puc-boss-harlan-kelly-arested-by-feds-charged-in-bribery-scheme/'>purportedly funded by Walter Wong</a>. She was also <a target='_blank' href='https://missionlocal.org/2021/09/sources-naomi-kelly-comped-for-865-nyc-hotel-room-by-recology-along-with-mohammed-nuru/'>comped a $865 hotel bill by Recology</a>, alongside Mohammed Nuru.</p>", "photo": "images/naomiKelly.png", "total_links": 4.0}, {"id": "harlanKelly", "label": "Harlan Kelly", "guilt": "charged", "desc": "<h4>Harlan Kelly</h4><p>Former general manager of the Public Utilities Commission (PUC), Kelly was <a target='_blank' href='https://missionlocal.org/2020/11/puc-boss-harlan-kelly-arested-by-feds-charged-in-bribery-scheme/'>federally charged in a bribery scheme</a> involving Walter Wong in Nov. 2020. In Oct. 2021, he was charged with defrauding mortage lender Quicken Loans in a <target='_blank' href='https://missionlocal.org/2021/10/feds-accuse-ex-puc-boss-harlan-kelly-real-estate-broker-and-politico-victor-makras-in-bank-fraud-conspiracy/'>$1.3 million scheme</a>.</p>", "photo": "images/harlanKelly.png", "total_links": 5.0}, {"id": "puc", "label": "Public Utilities Commission", "guilt": "other", "desc": "<h4>Public Utilities Commission</h4><p>Provides water, wastewater, and electric power services to the city. Its former general manager, Harlan Kelly, was <a target='_blank' href='https://missionlocal.org/2020/11/puc-boss-harlan-kelly-arested-by-feds-charged-in-bribery-scheme/'>federally charged in a bribery scheme</a> in Nov. 2020. He was <a target='_blank' href='https://missionlocal.org/2021/05/dennis-herrera-puc/'>replaced by former City Attorney Dennis Herrera</a> in a move described as \u201cputting the city\u2019s top watchdog at the head of the PUC.\u201d</p>", "photo": "images/puc.png", "total_links": 3.0}, {"id": "paulGiusti", "label": "Paul Giusti", "guilt": "guilty", "desc": "<h4>Paul Giusti</h4><p>Recology executive Paul Giusti was <a target='_blank' href='https://missionlocal.org/2020/11/feds-charge-recology-exec-in-long-running-alleged-mohammed-nuru-bribery-scheme/'>federally charged with money laundering and bribery</a> in Nov. 2020. In July 2021, he pleaded guilty to funnelling hundreds of thousands of dollars into non-profits controlled by Mohammed Nuru in exchange for hiked garbage rates for San Francisco residents. He also <a target='_blank' href='https://www.justice.gov/usao-ndca/pr/trash-company-executive-agrees-plead-guilty-conspiracy-and-cooperate-federal'>secured a job for Nuru's son</a> at a Recology subsidiary.</p>", "photo": "images/paulGiusti.jpg", "total_links": 2.0}, {"id": "nickBovis", "label": "Nick Bovis", "guilt": "guilty", "desc": "<h4>Nick Bovis</h4><p>Restaurateur Nick Bovis pleaded guilty to wire fraud in May 2020 and may face up to 20 years in prison. He was charged with participating in <a target='_blank' href='https://missionlocal.org/2020/01/mohammed-nuru-director-of-san-francisco-public-works-arrested-by-fbi/'>multiple bribery schemes</a>, including attempting to bribe someone at the Airport Commission to secure a restaurant lease and having public bids rigged in his favor by Mohammed Nuru.</p>", "photo": "images/nickBovis.jpg", "total_links": 2.0}, {"id": "zhangLi", "label": "Zhang Li", "guilt": "other", "desc": "<h4>Zhang Li</h4><p>Chinese billionaire and developer Zhang Li has been targeted with <a target='_blank' href='https://missionlocal.org/2020/02/mohammed-nuru-investigation-city-attorney-fires-off-14-subpoenas-chinese-billionaire-developer-zhang-li-and-permit-expediter-walter-wong-targeted/'>multiple subpoenas</a> because of his involvement with Walter Wong and Mohammed Nuru. Zhang Li owns the 555 Fulton development that prompted an FBI investigation. He allegedly <a target='_blank' href='https://missionlocal.org/2020/02/mohammed-nuru-investigation-man-identified-as-contractor-1-worked-out-of-building-owned-by-contractor-2-walter-wong/'>gifted Nuru \"some stone\" and thousands of dollars of alcohol</a> during a trip to China.</p>", "photo": "images/zhangLi.jpg", "total_links": 3.0}, {"id": "johnPorter", "label": "John Porter", "guilt": "charged", "desc": "<h4>John Porter</h4><p>Former Vice-President of Recology John Porter was <a target='_blank' href='https://missionlocal.org/2021/04/feds-charge-former-recology-vp-with-bribery-in-mohammed-nuru-case/'>federally charged for participating in a bribery scheme</a> that saw over a million dollars funnelled into Mohammed Nuru's favored non-profits in exchange for increased waste management rates.</p>", "photo": "images/johnPorter.jpg", "total_links": 2.0}, {"id": "sanFranciscoParksAlliance", "label": "San Francisco Parks Alliance", "guilt": "other", "desc": "<h4>San Francisco Parks Alliance</h4><p>A non-profit dedicated to improving public spaces in the city. An account held by the San Francisco Parks Alliance (SFPA) functioned as <a target='_blank' href='https://missionlocal.org/2020/10/nuru-recology-parks-alliance-clean-city/'>a slush fund for Mohammed Nuru</a>, into which Recology executives directed upwards of a million dollars.</p>", "photo": "images/sanFranciscoParksAlliance.jpg", "total_links": 2.0}, {"id": "londonBreed", "label": "London Breed", "guilt": "other", "desc": "<h4>London Breed</h4><p>In Aug. 2021, Mayor of San Francisco London Breed was <a target='_blank' href='https://missionlocal.org/2021/08/mayor-london-breeds-23k-ethics-fine-is-ratified-and-everyone-comes-out-looking-bad/'>fined nearly $23,000 for \"a series of of legal and ethical missteps\"</a>. These missteps include: accepting campaign donations above legal limits, using her position to seek clemency for her incarcerated brother, and accepting gifts from Mohammed Nuru.</p>", "photo": "images/londonBreed.png", "total_links": 3.0}, {"id": "sandraZuniga", "label": "Sandra Zuniga", "guilt": "guilty", "desc": "<h4>Sandra Zuniga</h4><p>Sandra Zuniga is the former head of the Office of Neighborhood Services and the city\u2019s \u201cFix-It Program,\u201d both of which sit within the Mayor's Office. In Mar. 2021, she <a target='_blank' href='https://missionlocal.org/2021/03/san-francisco-corruption/'>pleaded guilty to a money-laundering conspiracy</a> that went back until at least 2010. She was also Mohammed Nuru's girlfriend and <a target='_blank' href='https://missionlocal.org/2020/06/mohammed-nuru-case-three-more-hit-with-federal-charges-including-sandra-zuniga-mayoral-staffer-and-girlfriend-1/'>the joint beneficiary of some of his alleged bribes</a> \u2013 for example, her trip to Santiago, Chile with Nuru was heavily subsidized by Walter Wong. She is cooperating with the FBI.</p>", "photo": "images/sandraZuniga.png", "total_links": 3.0}, {"id": "azulWorksInc", "label": "Azul Works, Inc.", "guilt": "other", "desc": "<h4>Azul Works, Inc.</h4><p>Azul Works, Inc. is a construction company founded by Balmore Hernandez. In Sep. 2020, Hernandez pleaded guilty to <a target='_blank' href='https://missionlocal.org/2020/09/tractor-mohammed-nuru-fbi-doj/'>bribing Mohammed Nuru</a> for favorable public contracts. Azul Works also <a target='_blank' href='https://missionlocal.org/2021/03/san-francisco-corruption/'>completed work for the Public Utilities Commission</a>, despite being fined thousands of dollars for failing to fulfil some contractual obligations.</p>", "photo": "images/azulWorksInc.png", "total_links": 2.0}, {"id": "balmoreHernandez", "label": "Balmore Hernandez", "guilt": "guilty", "desc": "<h4>Balmore Hernandez</h4><p>Balmore Hernandez, former Department of Public Works employee and founder of construction company Azul Works, pleaded guilty <a target='_blank' href='https://missionlocal.org/2020/09/tractor-mohammed-nuru-fbi-doj/'>to conspiring to commit fraud</a> in Sep. 2020. He spent around $250,000 on building work at Mohammed Nuru's vacation home and (alongside two other contractors) <a target='_blank' href='https://missionlocal.org/2020/09/tractor-mohammed-nuru-fbi-doj/'>bribed him with a $40,000 tractor</a>. He had hoped to sway Nuru to <a target='_blank' href='https://missionlocal.org/2020/06/mohammed-nuru-case-three-more-hit-with-federal-charges-including-sandra-zuniga-mayoral-staffer-and-girlfriend-1/'>approve an asphalt plant</a> on Port of San Francisco land. He is cooperating with the FBI.</p>", "photo": "images/balmoreHernandez.png", "total_links": 5.0}, {"id": "florenceKong", "label": "Florence Kong", "guilt": "guilty", "desc": "<h4>Florence Kong</h4><p>Florence Kong owns a construction company and construction-debris recycling company that has <a target='_blank' href='https://www.justice.gov/usao-ndca/pr/public-contractor-sentenced-prison-bribing-san-francisco-public-official-and-making'>contracts with the Department of Public Works</a>. In Feb. 2021, she <a target='_blank' href='https://missionlocal.org/2020/09/tractor-mohammed-nuru-fbi-doj/'>pleaded guilty to bribing Nuru</a> with cash, costly meals, a gate for his vacation home, and a Rolex watch worth nearly $40,000 in exchange for favorable contracts.</p>", "photo": "images/florenceKong.png", "total_links": 1.0}, {"id": "mayorsOffice", "label": "Mayor's Office", "guilt": "other", "desc": "<h4>Mayor's Office</h4><p>Mayor's Office employee Sandra Zuniga <a target='_blank' href='https://missionlocal.org/2021/03/san-francisco-corruption/'>pleaded guilty to bribery charges</a> in Mar. 2021. Mayor London Breed has been fined nearly $23,000 for a series of <a target='_blank' href='https://missionlocal.org/2021/08/mayor-london-breeds-23k-ethics-fine-is-ratified-and-everyone-comes-out-looking-bad/'>ethical violations</a>.</p>", "photo": "images/mayorsOffice.jpg", "total_links": 2.0}, {"id": "stephenKwok", "label": "Stephen Kwok", "guilt": "other", "desc": "<h4>Stephen Kwok</h4><p>Stephen Kwok is a senior building inspector at the Department of Building Inspection and helps lead a task force to deal with illegal \"Accessory Dwelling Units,\" or ADUs. In Aug. 2021, he was discovered to have an <a target='_blank' href='https://missionlocal.org/2021/08/dbi-adu-san-francisco/'>illegal ADU in his backyard</a>.</p>", "photo": "images/stephenKwok.png", "total_links": 2.0}, {"id": "angusMcCarthy", "label": "Angus McCarthy", "guilt": "other", "desc": "<h4>Angus McCarthy</h4><p>Angus McCarthy is the president of the Building Inspection Commission, which oversees the Department of Building Inspection (DBI). In Sep. 2021, <a target='_blank' href='https://missionlocal.org/2021/09/supes-call-for-city-attorney-investigation-of-angus-mccarthy-propose-ballot-measure-to-remake-dept-of-building-inspection/'>supervisors called for an investigation</a> into allegations that parts of McCarthy's private home did not have the correct permits, and into his statement that he had DBI materials redrafted by private builders.</p>", "photo": "images/angusMcCarthy.png", "total_links": 2.0}, {"id": "2867SanBrunoAve", "label": "2867 San Bruno Ave.", "guilt": "other", "desc": "<h4>2867 San Bruno Ave.</h4><p>2867 San Bruno Ave. is a mixed-use building that includes <a target='_blank' href='https://missionlocal.org/2021/06/department-of-building-inspection-bernie-curran-2867-san-bruno-rebar-shmeebar/'>20 illegal housing units and a longstanding \"temporary\" fire escape</a>. Its final inspection was signed off by Bernie Curran. The building is <a target='_blank' href='https://dbiweb02.sfgov.org/dbipts/Default.aspx?page=PermitAgents&PermitNo=201905291902'>tied to SIA Consulting</a> \u2013 the family business of Freydoon Ghassemzadeh, who gave Curran an undisclosed $180,000 \"loan\". </p>", "photo": "images/2867SanBrunoAve.png", "total_links": 2.0}, {"id": "freydoonGhassemzadeh", "label": "Freydoon Ghassemzadeh", "guilt": "other", "desc": "<h4>Freydoon Ghassemzadeh</h4><p>Developer Freydoon Ghassemzadeh gave Bernie Curran an undisclosed <a target='_blank' href='https://missionlocal.org/2021/06/department-of-building-inspection-bernie-curran-2867-san-bruno-rebar-shmeebar/'>$180,000 \"loan\"</a> before Curran worked on permitting his projects. His family business is <a target='_blank' href='https://dbiweb02.sfgov.org/dbipts/Default.aspx?page=PermitAgents&PermitNo=201905291902'>SIA Consulting</a>, which is tied to the problem-riddled 2867 San Bruno Ave. development.</p>", "photo": "images/freydoonGhassemzadeh.png", "total_links": 2.0}, {"id": "victorMakras", "label": "Victor Makras", "guilt": "charged", "desc": "<h4>Victor Makras</h4><p>In Oct. 2021, real estate broker Victor Makras was federally charged in a <a target='_blank' href='https://missionlocal.org/2021/10/feds-accuse-ex-puc-boss-harlan-kelly-real-estate-broker-and-politico-victor-makras-in-bank-fraud-conspiracy/'>bank fraud conspiracy</a> with Walter Wong and Harlan Kelly. Makras has sat on a sm\u00f6rg\u00e5sbord of city commissions, including the Port Commission, Retirement Board, Board of Appeals, Police Commission and the Public Utilities Commission. </p>", "photo": "images/victorMakras.jpg", "total_links": 3.0}, {"id": "JCDecaux", "label": "JCDecaux", "guilt": "other", "desc": "<h4>JCDecaux</h4><p>Outdoor advertising corporation JCDecaux is contracted by the Department of Public Works to provide San Francisco with public toilets. Their contract seems to be <a target='_blank' href='https://missionlocal.org/2020/07/nuru-jcdecaux-toilet-san-francisco/'>less favorable</a> than bids offered by other companies and was <a target='_blank' href='https://missionlocal.org/2020/02/san-franciscos-toilet-and-kiosk-contract-with-jcdecaux-under-investigation-in-wake-of-public-works-boss-mohammed-nurus-arrest/'>investigated in Feb. 2020</a>. Mohammed Nuru was <a target='_blank' href='https://missionlocal.org/2020/02/san-franciscos-toilet-and-kiosk-contract-with-jcdecaux-under-investigation-in-wake-of-public-works-boss-mohammed-nurus-arrest/'>purportedly entertained</a> at the company's waterfront farmhouse.</p>", "photo": "images/JCDecaux.png", "total_links": 3.0}, {"id": "garbageOdyssey", "label": "The Garbage Odyssey", "guilt": "other", "desc": "<h4>The Garbage Odyssey</h4><p>Since 2018, the Department of Public Works has been <a target='_blank' href='https://missionlocal.org/2021/10/public-works-begins-looking-at-off-the-shelf-trash-can-models-to-test-alongside-its-12000-to-20000-beauties/'>designing custom trash cans</a> for the city at significant expense. They are meant to replace the much-maligned Renaissance cans currently in use \u2013 which were supplied by the <a target='_blank' href='https://missionlocal.org/2021/09/san-francisco-garbage-can-designer/'>Walter-Wong-affiliated Alternate Choice LLC.</a></p>", "photo": "images/garbageOdyssey.png", "total_links": 2.0}, {"id": "juliaDawson", "label": "Julia Dawson", "guilt": "other", "desc": "<h4>Julia Dawson</h4><p>Julia Dawson, Department of Public Works' former deputy director for finance and administration, was purportedly <a target='_blank' href='https://missionlocal.org/2021/03/public-works-spent-years-analyzing-recologys-unjust-rate-hike-but-overcharging-of-san-franciscans-continued/'>aware of Recology's overcharging</a> at least as early as Jan. 2019, but overcharging continued for years. She also told supervisors in July 2020 that company JCDecaux's competitor did not raise concerns over the fairness of its bid to provide public toilets \u2013 something <a target='_blank' href='https://missionlocal.org/2020/07/nuru-jcdecaux-toilet-san-francisco/'>later contradicted by written evidence</a>.</p>", "photo": "images/juliaDawson.jpg", "total_links": 3.0}]

var links = [{"target": "bernieCurran", "source": "angusMcCarthy", "desc": "<p>Bernie Curran <a target='_blank' href='https://missionlocal.org/2021/09/angus-mccarthy-president-of-dept-of-building-inspection-commission-admits-he-has-private-builders-edit-redraft-dept-of-building-inspection-materials/'>signed off the permits</a> on Angus McCarthy's home which have now led to calls for an investigation.</p>"}, {"target": "azulWorksInc", "source": "balmoreHernandez", "desc": "<p>Balmore Hernandez founded construction company Azul Works, Inc.</p>"}, {"target": "balmoreHernandez", "source": "sandraZuniga", "desc": "<p>The $40,000 tractor Balmore Hernandez and his fellow contractors used to bribe Mohammed Nuru was <a target='_blank' href='https://missionlocal.org/2021/03/san-francisco-corruption/'>delivered in Sandra Zuniga's name</a>.</p>"}, {"target": "balmoreHernandez", "source": "mohammedNuru", "desc": "<p>Balmore Hernandez spent about $250,000 on construction work around Mohammed Nuru's vacation home and (along with two other contractors) <a target='_blank' href='https://missionlocal.org/2020/09/tractor-mohammed-nuru-fbi-doj/'>bribed him with a $40,000 tractor</a>.</p>"}, {"target": "balmoreHernandez", "source": "walterWong", "desc": "<p>Balmore Hernadez's company, Azul Works, Inc., was housed at 205 13th St. \u2013 <a target='_blank' href='https://missionlocal.org/2020/02/mohammed-nuru-investigation-man-identified-as-contractor-1-worked-out-of-building-owned-by-contractor-2-walter-wong/'>a building owned by Walter Wong</a> and used as a headquarters for his own businesses.</p>"}, {"target": "bernieCurran", "source": "rodrigoSantos", "desc": "<p>Rodrigo Santos directed his clients to <a target='_blank' href='https://missionlocal.org/2021/08/rodrigo-santos-admits-to-hiring-ex-dbi-directors-kids-plural-and-other-gems-from-dennis-richards-ongoing-litigation/'>donate money to Curran's favored non-profits</a> in exchange for getting permits signed off.</p>"}, {"target": "bernieCurran", "source": "patrickORiordan", "desc": "<p>Before he was interim director of the Department of Building Inspection, Patrick O'Riordan was Bernie Curran's direct supervisor.</p>"}, {"target": "bernieCurran", "source": "2867SanBrunoAve", "desc": "<p>Bernie Curran signed off the final inspection of 2867 San Bruno Ave.</p>"}, {"target": "bernieCurran", "source": "freydoonGhassemzadeh", "desc": "<p>Freydoon Ghassemzadeh gave Bernie Curran an <a target='_blank' href='https://missionlocal.org/2021/06/department-of-building-inspection-bernie-curran-2867-san-bruno-rebar-shmeebar/'>undisclosed $180,000 \"loan\"</a>. </p>"}, {"target": "dbi", "source": "walterWong", "desc": "<p>Walter Wong purportedly ran a <a target='_blank' href='https://missionlocal.org/2021/07/walter-wong-settlement/'>\"department within a department\"</a> at the Department of Building Inspection, often side-stepping the plan-check department and getting his clients' permits approved with little oversight.</p>"}, {"target": "dbi", "source": "rodrigoSantos", "desc": "<p>Rodrigo Santos was once the president of the Building Inspection Commission and used his connections there to expedite permits for clients \u2013 even after he was charged with <a target='_blank' href='https://missionlocal.org/2020/09/rodrigo-santos-dbi/'>$478,000 of bank fraud</a> in Sep. 2020.</p>"}, {"target": "dbi", "source": "555fulton", "desc": "<p>Records for 555 Fulton St. disappeared from the Department of Building Inspection's servers for a week, <a target='_blank' href='https://missionlocal.org/2020/02/mohammed-nuru-investigation-the-555-fulton-project-disappeared-off-the-citys-computer-system-heres-how-that-happened/'>prompting a visit from the FBI</a>.</p>"}, {"target": "dbi", "source": "bernieCurran", "desc": "<p>Bernie Curran was a senior inspector for the Department of Building Inspection until he was <a target='_blank' href='https://missionlocal.org/2021/06/department-of-building-inspection-bernie-curran-2867-san-bruno-rebar-shmeebar/'>suspended in June 2021</a> for failing to report a $180,000 \"loan\" from a developer.</p>"}, {"target": "dbi", "source": "patrickORiordan", "desc": "<p>Patrick O'Riordan is interim director of the Department of Building Inspection.</p>"}, {"target": "dbi", "source": "tomHui", "desc": "<p>Tom Hui was director of the Department of Building Inspection until Mar. 2020, when he was <a target='_blank' href='https://missionlocal.org/2020/03/department-of-building-inspection-head-tom-hui-suspended-allegations-of-wrongdoing-stretching-back-to-2011-uncovered-during-city-attorney-probe-of-mohammed-nuru/'>suspended for a decade of alleged wrongdoing</a>.</p>"}, {"target": "dbi", "source": "stephenKwok", "desc": "<p>Stephen Kwok is a senior inspector at the Department of Building Inspection.</p>"}, {"target": "dbi", "source": "angusMcCarthy", "desc": "<p>Angus McCarthy is the president of the Building Inspection Commission, which oversees the Department of Building Inspection.</p>"}, {"target": "dpw", "source": "mohammedNuru", "desc": "<p>Mohammed Nuru was director of the Department of Public Works until Jan. 2020, when he was <a target='_blank' href='https://missionlocal.org/2020/01/mohammed-nuru-director-of-san-francisco-public-works-arrested-by-fbi/'>indicted on corruption charges</a>.</p>"}, {"target": "dpw", "source": "recology", "desc": "<p>The Department of Public Works was aware that Recology was overcharging San Francisco taxpayers at least as early as Jan. 2019, but the <a target='_blank' href='https://missionlocal.org/2021/03/public-works-spent-years-analyzing-recologys-unjust-rate-hike-but-overcharging-of-san-franciscans-continued/'>overcharging continued for years</a>, until Recology owed almost $100 million.</p>"}, {"target": "dpw", "source": "walterWong", "desc": "<p>Walter Wong used his considerable connections at the Department of Public Works to <a target='_blank' href='https://missionlocal.org/2021/05/walter-wong-notorious-permit-expediter-and-central-figure-in-citys-corruption-scandal-reaches-settlement/'>enrich his own businesses</a>. He reached a $1.7 million settlement fine in May 2021 for his problematic contracts.</p>"}, {"target": "dpw", "source": "balmoreHernandez", "desc": "<p>Balmore Hernandez used to be an employee of the Department of Public Works.</p>"}, {"target": "mohammedNuru", "source": "florenceKong", "desc": "<p>Florence Kong \"gifted\" Mohammed Nuru with cash, costly meals, a gate for his vacation home, and a Rolex watch worth nearly $40,000.</p>"}, {"target": "freydoonGhassemzadeh", "source": "2867SanBrunoAve", "desc": "<p>The <a target='_blank' href='https://dbiweb02.sfgov.org/dbipts/Default.aspx?page=PermitAgents&PermitNo=201905291902'>engineer recorded as working</a> on 2867 San Bruno Ave. was from Freydoon Ghassemzadeh's family business.</p>"}, {"target": "harlanKelly", "source": "walterWong", "desc": "<p>Harlan Kelly was <a target='_blank' href='https://missionlocal.org/2020/11/puc-boss-harlan-kelly-arested-by-feds-charged-in-bribery-scheme/'>charged with fraud</a> after allegedly accepting gifts from Walter Wong \u2013 including multiple international trips, cash, free meals, and even personal car service \u2013 purportedly in exchange for favors and insider information.</p>"}, {"target": "johnPorter", "source": "recology", "desc": "<p>John Porter is the former Vice-President of Recology.</p>"}, {"target": "mohammedNuru", "source": "johnPorter", "desc": "<p>John Porter was <a target='_blank' href='https://missionlocal.org/2021/04/feds-charge-former-recology-vp-with-bribery-in-mohammed-nuru-case/'>federally charged for participating in a bribery scheme</a> that saw upwards of a million dollars funnelled into Mohammed Nuru's favored non-profits in exchange for increased waste management rates.</p>"}, {"target": "mohammedNuru", "source": "londonBreed", "desc": "<p>London Breed and Mohammed Nuru are longtime friends and were once romantic partners. In 2019, Breed received a <a target='_blank' href='https://missionlocal.org/2020/02/mohammed-nuru-investigation-mayor-london-breed-had-a-romantic-relationship-with-ousted-public-works-director/'>gift of $5,600 from Nuru</a> for car repairs and rental.</p>"}, {"target": "londonBreed", "source": "mayorsOffice", "desc": "<p>London Breed is the head of the Mayor's Office.</p>"}, {"target": "mohammedNuru", "source": "walterWong", "desc": "<p>Walter Wong used his influence with Mohammed Nuru to <a target='_blank' href='https://missionlocal.org/2021/05/walter-wong-notorious-permit-expediter-and-central-figure-in-citys-corruption-scandal-reaches-settlement/'>enrich his own businesses</a> in exchange for bribes, such as help setting up international trips.</p>"}, {"target": "mohammedNuru", "source": "recology", "desc": "<p>Mohammed Nuru has been charged with taking part in a <a target='_blank' href='https://missionlocal.org/2020/11/feds-charge-recology-exec-in-long-running-alleged-mohammed-nuru-bribery-scheme/'>bribery scheme</a> with waste management company Recology.</p>"}, {"target": "mohammedNuru", "source": "555fulton", "desc": "<p>Mohammed Nuru allegedly <a target='_blank' href='https://missionlocal.org/2020/02/mohammed-nuru-investigation-the-555-fulton-project-disappeared-off-the-citys-computer-system-heres-how-that-happened/'>pulled strings</a> to move along the problematic development at 555 Fulton St.</p>"}, {"target": "naomiKelly", "source": "harlanKelly", "desc": "<p>Former City Administrator Naomi Kelly and former head of the Public Utilities Commission Harlan Kelly are married.</p>"}, {"target": "mohammedNuru", "source": "naomiKelly", "desc": "<p>Naomi Kelly and Mohammed Nuru were allegedly both <a target='_blank' href='https://missionlocal.org/2021/09/sources-naomi-kelly-comped-for-865-nyc-hotel-room-by-recology-along-with-mohammed-nuru/'>comped $865 in hotel fees</a> by Recology during a trip to New York City.</p>"}, {"target": "naomiKelly", "source": "recology", "desc": "<p>Naomi Kelly was allegedly <a target='_blank' href='https://missionlocal.org/2021/09/sources-naomi-kelly-comped-for-865-nyc-hotel-room-by-recology-along-with-mohammed-nuru/'>comped $865 in hotel fees</a> by Recology in 2017.</p>"}, {"target": "naomiKelly", "source": "walterWong", "desc": "<p>Walter Wong allegedly funded Naomi Kelly's 2016 <a target='_blank' href='https://missionlocal.org/2020/11/puc-boss-harlan-kelly-arested-by-feds-charged-in-bribery-scheme/'>trip to China and Hong Kong</a>.</p>"}, {"target": "mohammedNuru", "source": "nickBovis", "desc": "<p>In Jan. 2020, Nick Bovis was charged with participating in <a target='_blank' href='https://missionlocal.org/2020/01/mohammed-nuru-director-of-san-francisco-public-works-arrested-by-fbi/'>multiple bribery schemes</a> alongside Mohammed Nuru, including attempting to bribe someone at the Airport Commission to secure a restaurant lease and having public bids rigged in his favor.</p>"}, {"target": "nickBovis", "source": "londonBreed", "desc": "<p>Then-supervisor London Breed received a <a target='_blank' href='https://missionlocal.org/2021/08/mayor-london-breeds-23k-ethics-fine-is-ratified-and-everyone-comes-out-looking-bad/'>$1,250 campaign donation from Nick Bovis</a> in order to secure a float in the Pride parade. The donation was not reported by Breed's campaign and exceeded the $500 maximum.</p>"}, {"target": "mohammedNuru", "source": "paulGiusti", "desc": "<p>Recology executive Paul Giusti is accused of <a target='_blank' href='https://missionlocal.org/2020/11/feds-charge-recology-exec-in-long-running-alleged-mohammed-nuru-bribery-scheme/'>bribing Mohammed Nuru</a> in exchange for favorable garbage management rates for the company. He also <a target='_blank' href='https://missionlocal.org/2021/03/public-works-spent-years-analyzing-recologys-unjust-rate-hike-but-overcharging-of-san-franciscans-continued/'>found employment for Nuru's son</a>.</p>"}, {"target": "puc", "source": "harlanKelly", "desc": "<p>Harlan Kelly was the Public Utilities Commission's general manager until he was <a target='_blank' href='https://missionlocal.org/2020/11/puc-boss-harlan-kelly-arested-by-feds-charged-in-bribery-scheme/'>federally charged in a bribery scheme</a> in Nov. 2020.</p>"}, {"target": "puc", "source": "azulWorksInc", "desc": "<p>Azul Works Inc. was <a target='_blank' href='https://missionlocal.org/2021/03/san-francisco-corruption/'>hired by the Public Utilities Commission</a>, despite its involvement with the Mohammed Nuru scandal and its previous failure to fulfil its contractual obligation to hire a certain proportion of small and/or minority-owned firms.</p>"}, {"target": "recology", "source": "paulGiusti", "desc": "<p>Paul Giusti was a Recology executive until he was <a target='_blank' href='https://missionlocal.org/2020/11/feds-charge-recology-exec-in-long-running-alleged-mohammed-nuru-bribery-scheme/'>federally charged with money laundering and bribery</a> in Nov. 2020.</p>"}, {"target": "recology", "source": "sanFranciscoParksAlliance", "desc": "<p>Recology executives deposited upwards of a million dollars into a bank account held by the San Francisco Parks Alliance. The money was then used as a <a target='_blank' href='https://missionlocal.org/2020/10/nuru-recology-parks-alliance-clean-city/'>slush fund by Nuru</a>.</p>"}, {"target": "rodrigoSantos", "source": "tomHui", "desc": "<p>Rodrigo Santos hired both of <a target='_blank' href='https://missionlocal.org/2021/08/rodrigo-santos-admits-to-hiring-ex-dbi-directors-kids-plural-and-other-gems-from-dennis-richards-ongoing-litigation/'>Tom Hui's sons</a>.</p>"}, {"target": "sandraZuniga", "source": "mohammedNuru", "desc": "<p>Sandra Zuniga was Mohammed Nuru's romantic partner and allegedly <a target='_blank' href='https://missionlocal.org/2020/06/mohammed-nuru-case-three-more-hit-with-federal-charges-including-sandra-zuniga-mayoral-staffer-and-girlfriend-1/'>accepted his bribes in her name</a>.</p>"}, {"target": "sandraZuniga", "source": "mayorsOffice", "desc": "<p>Sandra Zuniga is the former head of the Office of Neighborhood Services and the city\u2019s \u201cFix-It Program,\u201d both of which sit within the Mayor's Office.</p>"}, {"target": "sanFranciscoParksAlliance", "source": "mohammedNuru", "desc": "<p>A bank account held by the San Francisco Parks Alliance acted as a <a target='_blank' href='https://missionlocal.org/2020/10/nuru-recology-parks-alliance-clean-city/'>slush fund for Mohammed Nuru</a>. He used much of the money to throw lavish parties.</p>"}, {"target": "stephenKwok", "source": "bernieCurran", "desc": "<p>Bernie Curran ventured out of his district to <a target='_blank' href='https://missionlocal.org/2021/08/dbi-adu-san-francisco/'>ostensibly inspect Stephen Kwok's property and placate neighbors</a> annoyed by the illegal unit \u2013 but these inspections were never officially recorded.</p>"}, {"target": "tomHui", "source": "walterWong", "desc": "<p>Tom Hui allegedly <a target='_blank' href='https://missionlocal.org/2021/07/walter-wong-settlement/'>\"turned large swaths of management of the department over to\u2026 [Walter] Wong</a>.\" Hui allegedly walked Wong's papers from station to station for their \"perfunctory rubber stamps.\"</p>"}, {"target": "tomHui", "source": "mohammedNuru", "desc": "<p>Tom Hui and Mohammed Nuru worked alongside one another on <a target='_blank' href='https://missionlocal.org/2020/03/department-of-building-inspection-head-tom-hui-suspended-allegations-of-wrongdoing-stretching-back-to-2011-uncovered-during-city-attorney-probe-of-mohammed-nuru/'>multiple projects</a> \u2013 including 555 Fulton St. Nuru also set up a job for Hui's son at the Department of Public Works.</p>"}, {"target": "tomHui", "source": "555fulton", "desc": "<p>Sources within the Department of Building Inspection said that Tom Hui <a target='_blank' href='https://missionlocal.org/2020/03/department-of-building-inspection-head-tom-hui-suspended-allegations-of-wrongdoing-stretching-back-to-2011-uncovered-during-city-attorney-probe-of-mohammed-nuru/'>\u201cliterally stood over people\u2019s shoulders\u201d</a> to expedite the controversial 555 Fulton St. project.</p>"}, {"target": "walterWong", "source": "555fulton", "desc": "<p>Walter Wong <a target='_blank' href='https://missionlocal.org/2021/07/walter-wong-settlement/'>handled the permitting on this project</a> and connected Zhang Li with Mohammed Nuru.</p>"}, {"target": "zhangLi", "source": "walterWong", "desc": "<p>Billionaire Zhang Li <a target='_blank' href='https://missionlocal.org/2020/02/mohammed-nuru-investigation-city-attorney-fires-off-14-subpoenas-chinese-billionaire-developer-zhang-li-and-permit-expediter-walter-wong-targeted/'>lavishly entertained Walter Wong on trips to China and Hong Kong</a>, allegedly in exchange for permitting help with 555 Fulton St.</p>"}, {"target": "zhangLi", "source": "mohammedNuru", "desc": "<p><a target='_blank' href='https://missionlocal.org/2020/02/mohammed-nuru-investigation-city-attorney-fires-off-14-subpoenas-chinese-billionaire-developer-zhang-li-and-permit-expediter-walter-wong-targeted/'>FBI wiretaps</a> suggest that Zhang Li  plied Mohammed Nuru with expensive alcohol and \"some stone\" in exchange for help with his 555 Fulton St. development.</p>"}, {"target": "zhangLi", "source": "555fulton", "desc": "<p>Billionaire Zhang Li owns the 555 Fulton St. development.</p>"}, {"target": "victorMakras", "source": "walterWong", "desc": "<p>Victor Makras was charged in a <a target='_blank' href='https://missionlocal.org/2021/10/feds-accuse-ex-puc-boss-harlan-kelly-real-estate-broker-and-politico-victor-makras-in-bank-fraud-conspiracy/'>bank fraud scheme</a> involving Walter Wong in Oct. 2021.</p>"}, {"target": "victorMakras", "source": "harlanKelly", "desc": "<p>Victor Makras was charged in a <a target='_blank' href='https://missionlocal.org/2021/10/feds-accuse-ex-puc-boss-harlan-kelly-real-estate-broker-and-politico-victor-makras-in-bank-fraud-conspiracy/'>bank fraud scheme</a> involving Harlan Kelly in Oct. 2021.</p>"}, {"target": "puc", "source": "victorMakras", "desc": "<p>Victor Makras served on the Public Utilities Commission board in the early 2000s.</p>"}, {"target": "JCDecaux", "source": "mohammedNuru", "desc": "<p>JCDecaux's contract to provide the city with toilets was <a target='_blank' href='https://missionlocal.org/2020/02/san-franciscos-toilet-and-kiosk-contract-with-jcdecaux-under-investigation-in-wake-of-public-works-boss-mohammed-nurus-arrest/'>investigated after Nuru's arrest</a>. Nuru was purportedly entertained by the company at an <a target='_blank' href='https://missionlocal.org/2020/02/san-franciscos-toilet-and-kiosk-contract-with-jcdecaux-under-investigation-in-wake-of-public-works-boss-mohammed-nurus-arrest/'>elegant waterfront farmhouse</a>.</p>"}, {"target": "JCDecaux", "source": "dpw", "desc": "<p>The Department of Public Works contracted JCDecaux to provide much-maligned public toilets, turning down competitors who offered <a target='_blank' href='https://missionlocal.org/2020/07/nuru-jcdecaux-toilet-san-francisco/'>tens of millions more dollars</a> for their business.</p>"}, {"target": "garbageOdyssey", "source": "dpw", "desc": "<p>The Department of Public Works set out on a long, expensive process to <a target='_blank' href='https://missionlocal.org/2021/09/san-francisco-garbage-can-designer/'>create custom trash cans</a> in 2018. The process is ongoing.</p>"}, {"target": "recology", "source": "juliaDawson", "desc": "<p>Julia Dawson was purportedly <a target='_blank' href='https://missionlocal.org/2021/03/public-works-spent-years-analyzing-recologys-unjust-rate-hike-but-overcharging-of-san-franciscans-continued/'>aware of Recology's overcharging</a> at least as early as Jan. 2019, but overcharging continued for years.</p>"}, {"target": "JCDecaux", "source": "juliaDawson", "desc": "<p>Julia Dawson told supervisors that JCDecaux's competitor did not raise concerns over the fairness of its bid to provide public toilets \u2013 something <a target='_blank' href='https://missionlocal.org/2020/07/nuru-jcdecaux-toilet-san-francisco/'>later contradicted by written evidence</a>.</p>"}, {"target": "dpw", "source": "juliaDawson", "desc": "<p>Julia Dawson was the deputy director of finance and administration at the Department of Public Works until she retired in May 2021.</p>"}, {"target": "garbageOdyssey", "source": "walterWong", "desc": "<p>The city's current Renaissance trash cans were provided by the <a target='_blank' href='https://missionlocal.org/2021/09/san-francisco-garbage-can-designer/'>Walter-Wong-affiliated company Alternate Choice LLC</a>.</p>"}, {"target": "bernieCurran", "source": "harlanKelly", "desc": "<p>Bernie Curran <a target='_blank' href='https://www.scribd.com/document/533824633/Kelly-Makras-Indictment'>signed off permits</a> for work on Harlan Kelly's house.</p>"}]

// set svg height and width
var width = window.innerWidth - 15
var height = window.innerHeight - 15
var svg = d3.select('svg')

// figure out highest number of connections
var maxConnections = getMax(nodes, "total_links")
var maxConnections = maxConnections.total_links

// choose how to size nodes - changes for portrait vs landscape
if (width > height) {
  var vizSize = width
}
else if (width < 300) {
  var vizSize = height * 0.7
}
else if (width < height) {
  var vizSize = height
}
else {
  var vizSize = width
}

// set radius scale
const radiusScale = d3.scaleSqrt()
  .domain([1, maxConnections])
  .range([(10 * (vizSize / 1100)) + 10, (50 * (vizSize / 1100)) + 10])

svg.attr('width', width).attr('height', height)

// create force simulation
var linkForce = d3
  .forceLink()
  .id(d => d.id)
  .strength(0.5)

var simulation = d3
  .forceSimulation()
  .force('link', linkForce.distance(50))
  .force('charge', d3.forceManyBody().strength(-vizSize / 1.2).strength(50))
  .force("collide", d3.forceCollide(d => radiusScale(d.total_links) + (vizSize / 50)).iterations(10))
  .force('center', d3.forceCenter(width / 2, height / 2))

var dragDrop = d3.drag().on('start', function (node) {
  node.fx = node.x
  node.fy = node.y
}).on('drag', function (node) {
  simulation.alphaTarget(0.7).restart()
  node.fx = d3.event.x
  node.fy = d3.event.y
}).on('end', function (node) {
  if (!d3.event.active) {
    simulation.alphaTarget(0)
  }
  node.fx = null
  node.fy = null
})

// create pop-up
var tooltip = d3.select("body")
  .append("div")
  .attr('class','tooltipdiv')
  .style("position", "absolute")
  .style("visibility", "hidden");

// create linking lines
var linkElements = svg.append("g")
  .attr("class", "links")
  .selectAll("line")
  .data(links)
  .enter()
  .append("line")
  .attr("stroke-width", 3)
	.attr("stroke", "rgba(50, 50, 50, 0.1)")
  .on('click', popup)
  .on('mouseover', mouseoverLink)
  .on('mouseout', mouseoutLink);

// create images
var defs = svg.selectAll("g.node")
    .data(nodes, function(d) { return d.id; })
    .enter()
    .append("svg:g")
    .attr("class", "node")
    .append("defs");

// create node circles
var nodeElements = svg.append("g")
  .attr("class", "nodes")
  .selectAll("circle")
  .data(nodes)
  .enter()
  .append("circle")
  .attr("id", function(d,i){ return "node_id"+i})
  .attr("r", d => radiusScale(d.total_links))
  .style("stroke-width", 3)
  .style("stroke", getNodeColor)
  .attr("fill",function(d) { return "url(#image"+ d.id +")" }  )
  .call(dragDrop)
  .on("click", popup)
  .on('mouseover', mouseoverNode)
  .on('mouseout', mouseoutNode);

// create node labels
var textElements = svg.append("g")
  .attr("class", "texts")
  .attr("font-family", "Calibri")
  .selectAll("text")
  .data(nodes)
  .enter().append("text")
    .text(function (node) { return  node.label })
	  .attr("font-size", 15)
    .attr("dx", 25)
    .attr("dx", d => radiusScale(d.total_links) + 7)
    .attr("dy", 5)
    .attr("text-anchor", "left")
    .attr("id", function(d,i){ return "label_id"+i})
    .attr("class", "shadow")
    .style("visibility", "hidden");

//
// FUNCTIONS LIVE HERE
//

// trigger pop-up when link or node are selected
function popup(d) {
  var tipX = d3.event.pageX - 110
  var tipY = d3.event.pageY + 5

  // stop going off left
  if (tipX < 0) {
    tipX = 0 + 10;
  }
  // stop squeezing against right
  if (width > 220 && tipX > width - 210) {
    tipX = width - 240;
  }

  // apply position
  tooltip.html(d.desc)
  .style("visibility", "visible")
  .style("left", tipX + "px")
  .style("top", tipY + "px");

  // see if bottom of tooltip is going off the screen
  const tooltipRect = tooltip.node().getBoundingClientRect();
  if (tooltipRect.bottom > height) {
    tipY = height - tooltipRect.height
  }

  // apply position... again
  tooltip.html(d.desc)
    .style("visibility", "visible")
    .style("left", tipX + "px")
    .style("top", tipY + "px");

  d3.event.stopPropagation();
}

// change link appearance on mouseover and mouseout
function mouseoverLink(d) {
  d3.select(this)
    .transition()
    .duration(100)
    .attr('stroke-width', 5)
    .attr('stroke', '#6b6b6b')
    .style("cursor", "pointer");
}
function mouseoutLink(d) {
  d3.select(this)
    .transition()
    .duration(100)
    .attr('stroke-width', 3)
    .attr('stroke', "rgba(50, 50, 50, 0.1)")
    .style("cursor", "default");
}

// change node + label appearance on mouseover and mouseout
function mouseoverNode(d, i) {
  d3.select("#node_id" + i)
    .transition()
    .duration(100)
    .style("stroke-width", 5)
    .style("stroke", '#6b6b6b')
    .style("cursor", "pointer");
  d3.select("#label_id" + i)
    .style("visibility", "visible");
  linkElements.attr('stroke-width', function(l) {
    if (d === l.source || d === l.target)
      return 5;
    else
      return 3;
  })
  .attr('stroke', function(l) {
    if (d === l.source || d === l.target)
      return '#6b6b6b';
    else
      return "rgba(50, 50, 50, 0.1)";
  });
}

function mouseoutNode(d, i) {
  d3.select("#node_id" + i)
    .transition()
    .duration(100)
    .style("stroke-width", 3)
    .style("stroke", getNodeColor)
    .style("cursor", "default");
  d3.select("#label_id" + i)
    .style("visibility", "hidden");
  linkElements.attr('stroke-width', 3)
    .attr('stroke', "rgba(50, 50, 50, 0.1)");
}

// set node size and colour
function getNodeColor(d) {
  if (d.guilt === "guilty") {return '#e8463a'}
  else if (d.guilt === "charged") {return '#eb9226'}
  else {return '#6b6b6b'}
}

// grab record with max nodes
function getMax(nodes, prop) {
    var max;
    for (var i=0 ; i<nodes.length ; i++) {
        if (max == null || parseInt(nodes[i][prop]) > parseInt(max[prop]))
            max = nodes[i];
    }
    return max;
}

//
// OTHER FUN STUFF LIVES HERE
//

// add images to circles
defs.append('pattern')
  .attr("id", function(d) { return "image"+ d.id;}  )
  .attr("width", 1)
  .attr("height", 1)
  .append("svg:image")
  .attr("xlink:href", function(d) { return d.photo;})
  .attr("width", (d => radiusScale(d.total_links) * 2))
  .attr("height", (d => radiusScale(d.total_links) * 2));

// update force simulation every tick
simulation.nodes(nodes).on('tick', () => {
  nodeElements
    .attr('cx', function (node) { return node.x = Math.max(50, Math.min(width - 50, node.x)); })
    .attr('cy', function (node) { return node.y = Math.max(50, Math.min(height - 50, node.y)); })
  textElements
    .attr('x', function (node) { return node.x })
    .attr('y', function (node) { return node.y })
  linkElements
    .attr('x1', function (link) { return link.source.x })
    .attr('y1', function (link) { return link.source.y })
    .attr('x2', function (link) { return link.target.x })
    .attr('y2', function (link) { return link.target.y })
})

// create links
simulation.force("link").links(links)



// remove pop-up if click elsewhere
d3.select('body').on('click', function() {tooltip.style("visibility", "hidden")})

</script>
</body>
</html>